Version 4
SHEET 1 6384 1680
WIRE 2528 -304 288 -304
WIRE 832 -144 736 -144
WIRE 976 -144 832 -144
WIRE 1072 -144 976 -144
WIRE 1216 -144 1072 -144
WIRE 1312 -144 1216 -144
WIRE 1456 -144 1456 -192
WIRE 1456 -144 1312 -144
WIRE 1552 -144 1456 -144
WIRE 1696 -144 1552 -144
WIRE 1792 -144 1696 -144
WIRE 1936 -144 1792 -144
WIRE 2032 -144 1936 -144
WIRE 2176 -144 2032 -144
WIRE 2288 -144 2176 -144
WIRE 880 -96 640 -96
WIRE 1120 -96 880 -96
WIRE 1360 -96 1120 -96
WIRE 1600 -96 1360 -96
WIRE 1840 -96 1600 -96
WIRE 2080 -96 1840 -96
WIRE 736 -80 736 -144
WIRE 976 -80 976 -144
WIRE 1216 -80 1216 -144
WIRE 1456 -80 1456 -144
WIRE 1696 -80 1696 -144
WIRE 1936 -80 1936 -144
WIRE 2176 -80 2176 -144
WIRE 640 -64 640 -96
WIRE 640 -64 544 -64
WIRE 688 -64 640 -64
WIRE 880 -64 880 -96
WIRE 928 -64 880 -64
WIRE 1120 -64 1120 -96
WIRE 1168 -64 1120 -64
WIRE 1360 -64 1360 -96
WIRE 1408 -64 1360 -64
WIRE 1600 -64 1600 -96
WIRE 1648 -64 1600 -64
WIRE 1840 -64 1840 -96
WIRE 1888 -64 1840 -64
WIRE 2080 -64 2080 -96
WIRE 2128 -64 2080 -64
WIRE 832 -32 832 -144
WIRE 832 -32 736 -32
WIRE 1072 -32 1072 -144
WIRE 1072 -32 976 -32
WIRE 1312 -32 1312 -144
WIRE 1312 -32 1216 -32
WIRE 1552 -32 1552 -144
WIRE 1552 -32 1456 -32
WIRE 1792 -32 1792 -144
WIRE 1792 -32 1696 -32
WIRE 2032 -32 2032 -144
WIRE 2032 -32 1936 -32
WIRE 2288 -32 2288 -144
WIRE 2288 -32 2176 -32
WIRE 736 192 736 16
WIRE 976 192 976 16
WIRE 1216 192 1216 16
WIRE 1456 192 1456 16
WIRE 1696 192 1696 16
WIRE 1936 192 1936 16
WIRE 2176 192 2176 16
WIRE 288 224 288 -304
WIRE 704 224 288 224
WIRE 944 224 800 224
WIRE 1184 224 1040 224
WIRE 1424 224 1280 224
WIRE 1664 224 1520 224
WIRE 1904 224 1760 224
WIRE 2144 224 2000 224
WIRE 2528 224 2528 -304
WIRE 2528 224 2240 224
WIRE 2656 224 2528 224
WIRE 2944 224 2752 224
WIRE 3264 224 3040 224
WIRE 736 336 736 256
WIRE 976 336 976 256
WIRE 1216 336 1216 256
WIRE 1456 336 1456 256
WIRE 1696 336 1696 256
WIRE 1936 336 1936 256
WIRE 2176 336 2176 256
WIRE 832 384 736 384
WIRE 1072 384 976 384
WIRE 1312 384 1216 384
WIRE 1552 384 1456 384
WIRE 1792 384 1696 384
WIRE 2032 384 1936 384
WIRE 2272 384 2176 384
WIRE 640 416 544 416
WIRE 688 416 640 416
WIRE 928 416 880 416
WIRE 1168 416 1120 416
WIRE 1408 416 1360 416
WIRE 1648 416 1600 416
WIRE 1888 416 1840 416
WIRE 2128 416 2080 416
WIRE 640 448 640 416
WIRE 880 448 880 416
WIRE 880 448 640 448
WIRE 1120 448 1120 416
WIRE 1120 448 880 448
WIRE 1360 448 1360 416
WIRE 1360 448 1120 448
WIRE 1600 448 1600 416
WIRE 1600 448 1360 448
WIRE 1840 448 1840 416
WIRE 1840 448 1600 448
WIRE 2080 448 2080 416
WIRE 2080 448 1840 448
WIRE 736 512 736 432
WIRE 832 512 832 384
WIRE 832 512 736 512
WIRE 976 512 976 432
WIRE 976 512 832 512
WIRE 1072 512 1072 384
WIRE 1072 512 976 512
WIRE 1216 512 1216 432
WIRE 1216 512 1072 512
WIRE 1312 512 1312 384
WIRE 1312 512 1216 512
WIRE 1456 512 1456 432
WIRE 1456 512 1312 512
WIRE 1552 512 1552 384
WIRE 1552 512 1456 512
WIRE 1696 512 1696 432
WIRE 1696 512 1552 512
WIRE 1792 512 1792 384
WIRE 1792 512 1696 512
WIRE 1936 512 1936 432
WIRE 1936 512 1792 512
WIRE 2032 512 2032 384
WIRE 2032 512 1936 512
WIRE 2176 512 2176 432
WIRE 2176 512 2032 512
WIRE 2272 512 2272 384
WIRE 2272 512 2176 512
WIRE 240 560 192 560
WIRE 1456 560 1456 512
WIRE 16 576 -64 576
WIRE 240 592 192 592
WIRE -224 656 -224 624
WIRE -224 768 -224 736
WIRE -64 768 -64 736
WIRE 960 1024 960 992
WIRE 960 1024 912 1024
WIRE 1008 1024 960 1024
WIRE 912 1056 912 1024
WIRE 704 1072 656 1072
WIRE 864 1072 800 1072
WIRE 1008 1104 1008 1024
WIRE 1008 1104 912 1104
WIRE 912 1168 912 1152
WIRE 1088 1168 912 1168
WIRE 1184 1168 1088 1168
WIRE 1360 1168 1264 1168
WIRE 1456 1168 1360 1168
WIRE -96 1184 -336 1184
WIRE 144 1184 80 1184
WIRE 912 1184 912 1168
WIRE -336 1216 -336 1184
WIRE 1360 1216 1360 1168
WIRE -96 1232 -192 1232
WIRE 144 1232 80 1232
WIRE 1008 1232 912 1232
WIRE 864 1264 656 1264
WIRE 912 1312 912 1280
WIRE 960 1312 912 1312
WIRE 1008 1312 1008 1232
WIRE 1008 1312 960 1312
WIRE -336 1328 -336 1296
WIRE 1360 1328 1360 1280
WIRE 960 1360 960 1312
WIRE 1360 1456 1360 1408
WIRE -192 1488 -192 1232
WIRE -96 1488 -192 1488
WIRE 256 1536 80 1536
FLAG -224 768 0
FLAG -224 624 Vdd
FLAG -64 768 0
FLAG 1456 560 0
FLAG 1456 -192 Vdd
FLAG -64 576 VIN
FLAG 240 560 VP
FLAG 240 592 VN
FLAG 544 416 VN
FLAG 544 -64 VP
FLAG 3264 224 clkOut
FLAG 256 1536 clkOut
FLAG -336 1328 0
FLAG 960 992 Vdd
FLAG 1088 1168 Vpd
FLAG 960 1360 0
FLAG 656 1072 UP
FLAG 656 1264 DOWN
FLAG 1360 1456 0
FLAG 1456 1168 VIN
FLAG 144 1184 UP
FLAG 144 1232 DOWN
SYMBOL voltage -224 640 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 1.8
SYMBOL voltage -64 640 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {VIN}
SYMBOL pmos4 688 16 M180
SYMATTR InstName M3
SYMATTR Value CMOSP
SYMATTR Value2 l={L_CS} w={WP_CS} ad={ADS(WP_CS, LD)} as={ADS(WP_CS, LD)} pd={PDS(WP_CS, LD)} ps={PDS(WP_CS, LD)}
SYMBOL nmos4 688 336 R0
SYMATTR InstName M4
SYMATTR Value CMOSN
SYMATTR Value2 l={L_CS} w={WN_CS} ad={ADS(WN_CS, LD)} as={ADS(WN_CS, LD)} pd={PDS(WN_CS, LD)} ps={PDS(WN_CS, LD)}
SYMBOL pmos4 928 16 M180
SYMATTR InstName M5
SYMATTR Value CMOSP
SYMATTR Value2 l={L_CS} w={WP_CS} ad={ADS(WP_CS, LD)} as={ADS(WP_CS, LD)} pd={PDS(WP_CS, LD)} ps={PDS(WP_CS, LD)}
SYMBOL nmos4 928 336 R0
SYMATTR InstName M6
SYMATTR Value CMOSN
SYMATTR Value2 l={L_CS} w={WN_CS} ad={ADS(WN_CS, LD)} as={ADS(WN_CS, LD)} pd={PDS(WN_CS, LD)} ps={PDS(WN_CS, LD)}
SYMBOL pmos4 1168 16 M180
SYMATTR InstName M7
SYMATTR Value CMOSP
SYMATTR Value2 l={L_CS} w={WP_CS} ad={ADS(WP_CS, LD)} as={ADS(WP_CS, LD)} pd={PDS(WP_CS, LD)} ps={PDS(WP_CS, LD)}
SYMBOL nmos4 1168 336 R0
SYMATTR InstName M8
SYMATTR Value CMOSN
SYMATTR Value2 l={L_CS} w={WN_CS} ad={ADS(WN_CS, LD)} as={ADS(WN_CS, LD)} pd={PDS(WN_CS, LD)} ps={PDS(WN_CS, LD)}
SYMBOL pmos4 1408 16 M180
SYMATTR InstName M9
SYMATTR Value CMOSP
SYMATTR Value2 l={L_CS} w={WP_CS} ad={ADS(WP_CS, LD)} as={ADS(WP_CS, LD)} pd={PDS(WP_CS, LD)} ps={PDS(WP_CS, LD)}
SYMBOL nmos4 1408 336 R0
SYMATTR InstName M10
SYMATTR Value CMOSN
SYMATTR Value2 l={L_CS} w={WN_CS} ad={ADS(WN_CS, LD)} as={ADS(WN_CS, LD)} pd={PDS(WN_CS, LD)} ps={PDS(WN_CS, LD)}
SYMBOL pmos4 1648 16 M180
SYMATTR InstName M11
SYMATTR Value CMOSP
SYMATTR Value2 l={L_CS} w={WP_CS} ad={ADS(WP_CS, LD)} as={ADS(WP_CS, LD)} pd={PDS(WP_CS, LD)} ps={PDS(WP_CS, LD)}
SYMBOL nmos4 1648 336 R0
SYMATTR InstName M12
SYMATTR Value CMOSN
SYMATTR Value2 l={L_CS} w={WN_CS} ad={ADS(WN_CS, LD)} as={ADS(WN_CS, LD)} pd={PDS(WN_CS, LD)} ps={PDS(WN_CS, LD)}
SYMBOL pmos4 1888 16 M180
SYMATTR InstName M13
SYMATTR Value CMOSP
SYMATTR Value2 l={L_CS} w={WP_CS} ad={ADS(WP_CS, LD)} as={ADS(WP_CS, LD)} pd={PDS(WP_CS, LD)} ps={PDS(WP_CS, LD)}
SYMBOL nmos4 1888 336 R0
SYMATTR InstName M14
SYMATTR Value CMOSN
SYMATTR Value2 l={L_CS} w={WN_CS} ad={ADS(WN_CS, LD)} as={ADS(WN_CS, LD)} pd={PDS(WN_CS, LD)} ps={PDS(WN_CS, LD)}
SYMBOL pmos4 2128 16 M180
SYMATTR InstName M15
SYMATTR Value CMOSP
SYMATTR Value2 l={L_CS} w={WP_CS} ad={ADS(WP_CS, LD)} as={ADS(WP_CS, LD)} pd={PDS(WP_CS, LD)} ps={PDS(WP_CS, LD)}
SYMBOL nmos4 2128 336 R0
SYMATTR InstName M16
SYMATTR Value CMOSN
SYMATTR Value2 l={L_CS} w={WN_CS} ad={ADS(WN_CS, LD)} as={ADS(WN_CS, LD)} pd={PDS(WN_CS, LD)} ps={PDS(WN_CS, LD)}
SYMBOL inversor4 720 224 R0
SYMATTR InstName X1
SYMATTR SpiceLine VDD=1.8 L={L_INV} LD={LD} WN={WN_INV} WPFACT=1.5
SYMBOL inversor4 960 224 R0
SYMATTR InstName X2
SYMATTR SpiceLine VDD=1.8 L={L_INV} LD={LD} WN={WN_INV} WPFACT=1.5
SYMBOL inversor4 1200 224 R0
SYMATTR InstName X3
SYMATTR SpiceLine VDD=1.8 L={L_INV} LD={LD} WN={WN_INV} WPFACT=1.5
SYMBOL inversor4 1440 224 R0
SYMATTR InstName X4
SYMATTR SpiceLine VDD=1.8 L={L_INV} LD={LD} WN={WN_INV} WPFACT=1.5
SYMBOL inversor4 1680 224 R0
SYMATTR InstName X5
SYMATTR SpiceLine VDD=1.8 L={L_INV} LD={LD} WN={WN_INV} WPFACT=1.5
SYMBOL inversor4 1920 224 R0
SYMATTR InstName X6
SYMATTR SpiceLine VDD=1.8 L={L_INV} LD={LD} WN={WN_INV} WPFACT=1.5
SYMBOL inversor4 2160 224 R0
SYMATTR InstName X7
SYMATTR SpiceLine VDD=1.8 L={L_INV} LD={LD} WN={WN_INV} WPFACT=1.5
SYMBOL vco_current_source 64 576 R0
SYMATTR SpiceLine VDD=1.8 L={L_CS} W_BASE={WN_CS} WPFACT=1.5 WIDE_FACT={WIDE_FACT_CS} LD=0.48u R1={R1_CS} R2={R2_CS}
SYMATTR InstName X0
SYMBOL inversor 2672 224 R0
SYMATTR InstName XOUT1
SYMBOL inversor 2960 224 R0
SYMATTR InstName XOUT2
SYMBOL pfd2 -64 1216 R0
SYMATTR InstName X8
SYMBOL freq_divider_power_2 32 1440 M0
SYMATTR InstName X9
SYMBOL voltage -336 1200 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -446 74 Left 2
SYMATTR InstName V3
SYMATTR Value PULSE(0 1.8 0 70p 70p 20n 40n)
SYMBOL pmos4 864 1152 M180
SYMATTR InstName M1
SYMATTR Value CMOSP
SYMATTR Value2 l={L_FILTER} w={WP_FILTER} ad={ADS(WP_FILTER, LD)} as={ADS(WP_FILTER, LD)} pd={PDS(WP_FILTER, LD)} ps={PDS(WP_FILTER, LD)}
SYMBOL nmos4 864 1184 R0
SYMATTR InstName M2
SYMATTR Value CMOSN
SYMATTR Value2 l={L_FILTER} w={WN_FILTER} ad={ADS(WN_FILTER, LD)} as={ADS(WN_FILTER, LD)} pd={PDS(WN_FILTER, LD)} ps={PDS(WN_FILTER, LD)}
SYMBOL inversor 720 1072 R0
SYMATTR InstName X10
SYMBOL res 1280 1152 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 2.56k
SYMBOL res 1376 1424 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value 20k
SYMBOL cap 1344 1216 R0
SYMATTR InstName C1
SYMATTR Value 10p
TEXT -328 -144 Left 2 !.include "TSMC180.lib"
TEXT -328 -72 Left 2 !.func ADS(w, ld) = {w * ld}
TEXT -328 -40 Left 2 !.func PDS(w, ld) {w + 2*ld}
TEXT -328 24 Left 2 !.param L_INV = 0.18u
TEXT -328 -104 Left 2 !.param LD = 0.48u
TEXT -136 856 Left 2 !.tran 0 10u 0 100p
TEXT -328 56 Left 2 !.param WN_INV 0.57u
TEXT -328 184 Left 2 !.param L_CS = 0.9u
TEXT -328 216 Left 2 !.param WN_CS = 4u
TEXT -136 824 Left 2 !.param VIN 0
TEXT -328 248 Left 2 !.param WPFACT_CS = 1.5
TEXT -328 280 Left 2 !.param WIDE_FACT_CS = 3
TEXT 2856 416 Left 2 !.meas PERIOD TRIG V(clkOut)=0.9 TD={DELAY_BEFORE_SAMPLE} RISE=1 TARG V(clkOut)=0.9 TD={DELAY_BEFORE_SAMPLE} RISE=3
TEXT 2856 440 Left 2 !.meas FREQ PARAM 2/(PERIOD)
TEXT 2856 472 Left 2 !.meas TH TRIG V(clkOut)=1.7 RISE=300 TARG V(clkOut)=1.7 FALL=300
TEXT 2856 496 Left 2 !.meas TL TRIG V(clkOut)=0.1 FALL=300 TARG V(clkOut)=0.1 RISE=301
TEXT 2856 520 Left 2 !.meas DUTY_CYCLE_PERCENNT PARAM 100*TH/(TH+TL)
TEXT 2864 376 Left 2 !.param DELAY_BEFORE_SAMPLE 500n
TEXT 2856 544 Left 2 !.meas DUTY_CYCLE_2 INTEG 100*V(clkOut)/(1.8*200n) FROM 800n TO 1u
TEXT -328 312 Left 2 !.param R1_CS 20k
TEXT -328 376 Left 2 !.param WP_CS = { WN_CS * WPFACT_CS }
TEXT 408 640 Left 2 !.param COX_PER_M_SQUARED = 8.418m
TEXT 408 672 Left 2 !.param Ctot = { 2.5 * COX_PER_M_SQUARED * L_INV * (WN_INV + WP_INV) }
TEXT -328 88 Left 2 !.param WPFACT_INV = 1.5
TEXT -328 120 Left 2 !.param WP_INV = { WN_INV * WPFACT_INV }
TEXT 408 704 Left 2 !.param ID_CALC = {11.5u*VIN - 0.5u}
TEXT 408 736 Left 2 !.param N = 7
TEXT 408 768 Left 2 !.param FREQ_CALC = { ID_CALC / (N * Ctot * 1.8) }
TEXT 408 800 Left 2 !.meas F_CALC_MEAS PARAM FREQ_CALC
TEXT -328 344 Left 2 !.param R2_CS 86k
TEXT 424 1472 Left 2 !.param WP_FILTER = {WN_FILTER * WPFACT_FILTER}
TEXT 424 1376 Left 2 !.param L_FILTER = 1.8u
TEXT 424 1408 Left 2 !.param WN_FILTER = 4.2u
TEXT 424 1440 Left 2 !.param WPFACT_FILTER = 1.5
